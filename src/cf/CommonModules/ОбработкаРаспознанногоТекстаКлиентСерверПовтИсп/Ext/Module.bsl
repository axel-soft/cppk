///////////////////////////////////////////////////////////////////////////////////////////////////////
// Copyright (c) 2022, ООО 1С-Софт
// Все права защищены. Эта программа и сопроводительные материалы предоставляются 
// в соответствии с условиями лицензии Attribution 4.0 International (CC BY 4.0)
// Текст лицензии доступен по ссылке:
// https://creativecommons.org/licenses/by/4.0/legalcode
///////////////////////////////////////////////////////////////////////////////////////////////////////

#Область ПрограммныйИнтерфейс

Функция Команды() Экспорт
	
	Таблица = Новый Массив;
	
	ТокенПаттерн(Таблица, "СБольшойБуквы", Ложь, Ложь, Ложь, Ложь, "с большой буквы");
	ТокенПаттерн(Таблица, "БольшимиБуквами", Ложь, Ложь, Ложь, Ложь, "большими буквами");
	
	ОбратнаяСортировкаШеллаПоДлинеСлов(Таблица);
	
	Возврат Таблица;
	
КонецФункции

Функция ЗаменяемыеЗнаки() Экспорт
	
	Таблица = Новый Массив;
	
	//
	// Таблица, Токен, ПробелДоСлова, ПробелПослеСлова, ПробелДоЧисла, ПробелПослеЧисла, Паттерны
	//
	ТокенПаттерн(Таблица, "[", Истина, Ложь, Истина, Ложь, "открыть квадратную скобку", "квадратная скобка открывается", "квадратная скобка");
	ТокенПаттерн(Таблица, "]", Ложь, Истина, Ложь, Истина, "квадратная скобка закрывается", "закрыть квадратную скобку");
	ТокенПаттерн(Таблица, "{", Истина, Ложь, Истина, Ложь, "открыть фигурную скобку", "фигурная скобка открывается", "фигурная скобка");
	ТокенПаттерн(Таблица, "}", Ложь, Истина, Ложь, Истина, "фигурная скобка закрывается", "закрыть фигурную скобку");
	ТокенПаттерн(Таблица, "(", Истина, Ложь, Истина, Ложь, "открыть скобку", "скобка открывается", "скобка");
	ТокенПаттерн(Таблица, ")", Ложь, Истина, Ложь, Истина, "скобка закрывается", "закрыть скобку");
	ТокенПаттерн(Таблица, """", Истина, Ложь, Истина, Ложь, "кавычка открывается", "открыть кавычку", "кавычки открываются", "открыть кавычки");
	ТокенПаттерн(Таблица, """", Ложь, Истина, Ложь, Истина, "кавычка закрывается", "закрыть кавычку", "кавычки закрывается", "закрыть кавычки");
	ТокенПаттерн(Таблица, """", Истина, Истина, Истина, Истина, "кавычка", "двойная кавычка");
	ТокенПаттерн(Таблица, "'", Ложь, Истина, Ложь, Истина, "одинарная кавычка");
	ТокенПаттерн(Таблица, ";", Ложь, Истина, Ложь, Истина, "точка с запятой");
	ТокенПаттерн(Таблица, ":", Ложь, Истина, Ложь, Ложь, "двоеточие");
	ТокенПаттерн(Таблица, ",", Ложь, Истина, Ложь, Истина, "запятая");
	ТокенПаттерн(Таблица, "-", Ложь, Ложь, Ложь, Ложь, "дефис");
	ТокенПаттерн(Таблица, "-", Истина, Истина, Ложь, Ложь, "знак минус", "тире");
	ТокенПаттерн(Таблица, ".", Ложь, Истина, Ложь, Ложь, "точка");
	ТокенПаттерн(Таблица, "...", Ложь, Истина, Ложь, Истина, "многоточие");
	ТокенПаттерн(Таблица, "!", Ложь, Истина, Ложь, Истина, "восклицательный знак");
	ТокенПаттерн(Таблица, "?", Ложь, Истина, Ложь, Истина, "вопросительный знак", "знак вопроса");
	ТокенПаттерн(Таблица, "~", Истина, Истина, Истина, Истина, "знак тильда", "тильда");
	ТокенПаттерн(Таблица, "@", Ложь, Ложь, Ложь, Ложь, "знак собака", "знак собачка", "знак собачки", "собачка", "собака");
	ТокенПаттерн(Таблица, "#", Истина, Ложь, Истина, Ложь, "знак решетка", "знак решетки", "решетка");
	ТокенПаттерн(Таблица, "*", Истина, Ложь, Истина, Истина, "знак звездочка", "звездочка", "умножить");
	ТокенПаттерн(Таблица, "/", Ложь, Ложь, Истина, Истина, "знак слеша", "знак слэша", "знак деления", "слеш", "слэш", "дробь");
	ТокенПаттерн(Таблица, "%", Истина, Истина, Ложь, Истина, "процент", "процента", "процентов");
	ТокенПаттерн(Таблица, "&", Истина, Истина, Истина, Истина, "амперсанд", "амперсанда", "амперсандов");
	ТокенПаттерн(Таблица, "$", Истина, Истина, Истина, Истина, "знак доллара", "знак доллар", "доллар", "доллара", "долларов");
	ТокенПаттерн(Таблица, "₽", Истина, Истина, Истина, Истина, "знак рубль", "знак рубля", "рубль", "рубля", "рублей");
	ТокенПаттерн(Таблица, "+", Истина, Истина, Истина, Истина, "знак плюс");
	ТокенПаттерн(Таблица, "=", Истина, Истина, Истина, Истина, "знак равно");
	ТокенПаттерн(Таблица, ">", Истина, Истина, Истина, Истина, "знак больше");
	ТокенПаттерн(Таблица, "<", Истина, Истина, Истина, Истина, "знак меньше");
	ТокенПаттерн(Таблица, "*", Истина, Истина, Истина, Истина, "знак умножения", "звездочка", "астериск");
	ТокенПаттерн(Таблица, "№", Истина, Истина, Истина, Ложь, "номер");
	ТокенПаттерн(Таблица, Символы.ПС, Ложь, Ложь, Ложь, Ложь, "перенос строки", "с новой строки", "новая строка", "новый абзац", "абзац");
	
	ОбратнаяСортировкаШеллаПоДлинеСлов(Таблица);
	
	Возврат Таблица;
	
КонецФункции

Функция СоответствиеДляТрег() Экспорт
	
	Соответствие = Новый Соответствие;
	
	Соответствие.Вставить("а", "А");
	Соответствие.Вставить("б", "Б");
	Соответствие.Вставить("в", "В");
	Соответствие.Вставить("г", "Г");
	Соответствие.Вставить("д", "Д");
	Соответствие.Вставить("е", "Е");
	Соответствие.Вставить("ё", "Ё");
	Соответствие.Вставить("ж", "Ж");
	Соответствие.Вставить("з", "З");
	Соответствие.Вставить("и", "И");
	Соответствие.Вставить("й", "Й");
	Соответствие.Вставить("к", "К");
	Соответствие.Вставить("л", "Л");
	Соответствие.Вставить("м", "М");
	Соответствие.Вставить("н", "Н");
	Соответствие.Вставить("о", "О");
	Соответствие.Вставить("п", "П");
	Соответствие.Вставить("р", "Р");
	Соответствие.Вставить("с", "С");
	Соответствие.Вставить("т", "Т");
	Соответствие.Вставить("у", "У");
	Соответствие.Вставить("ф", "Ф");
	Соответствие.Вставить("х", "Х");
	Соответствие.Вставить("ц", "Ц");
	Соответствие.Вставить("ч", "Ч");
	Соответствие.Вставить("ш", "Ш");
	Соответствие.Вставить("щ", "Щ");
	Соответствие.Вставить("ъ", "Ъ");
	Соответствие.Вставить("ы", "Ы");
	Соответствие.Вставить("ь", "Ь");
	Соответствие.Вставить("э", "Э");
	Соответствие.Вставить("ю", "Ю");
	Соответствие.Вставить("я", "Я");
	
	Соответствие.Вставить("a", "A");
	Соответствие.Вставить("b", "B");
	Соответствие.Вставить("c", "C");
	Соответствие.Вставить("d", "D");
	Соответствие.Вставить("e", "E");
	Соответствие.Вставить("f", "F");
	Соответствие.Вставить("g", "G");
	Соответствие.Вставить("h", "H");
	Соответствие.Вставить("i", "I");
	Соответствие.Вставить("j", "J");
	Соответствие.Вставить("k", "K");
	Соответствие.Вставить("l", "L");
	Соответствие.Вставить("m", "M");
	Соответствие.Вставить("n", "N");
	Соответствие.Вставить("o", "O");
	Соответствие.Вставить("p", "P");
	Соответствие.Вставить("q", "Q");
	Соответствие.Вставить("r", "R");
	Соответствие.Вставить("s", "S");
	Соответствие.Вставить("t", "T");
	Соответствие.Вставить("u", "U");
	Соответствие.Вставить("v", "V");
	Соответствие.Вставить("w", "W");
	Соответствие.Вставить("x", "X");
	Соответствие.Вставить("y", "Y");
	Соответствие.Вставить("z", "Z");
	
	Возврат Соответствие;
	
КонецФункции

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

Процедура ТокенПаттерн(Таблица, Токен,
	ПробелДоСлова, ПробелПослеСлова,
	ПробелДоЧисла, ПробелПослеЧисла,
	Паттерн1, 
	Паттерн2 = Неопределено, 
	Паттерн3 = Неопределено, 
	Паттерн4 = Неопределено, 
	Паттерн5 = Неопределено, 
	Паттерн6 = Неопределено)
	
	ДобавитьСтроку(Таблица, Токен, Паттерн1, ПробелДоСлова, ПробелПослеСлова, ПробелДоЧисла, ПробелПослеЧисла);
	Если ЗначениеЗаполнено(Паттерн2) Тогда 
		ДобавитьСтроку(Таблица, Токен, Паттерн2, ПробелДоСлова, ПробелПослеСлова, ПробелДоЧисла, ПробелПослеЧисла);
	КонецЕсли;
	Если ЗначениеЗаполнено(Паттерн3) Тогда 
		ДобавитьСтроку(Таблица, Токен, Паттерн3, ПробелДоСлова, ПробелПослеСлова, ПробелДоЧисла, ПробелПослеЧисла);
	КонецЕсли;
	Если ЗначениеЗаполнено(Паттерн4) Тогда 
		ДобавитьСтроку(Таблица, Токен, Паттерн4, ПробелДоСлова, ПробелПослеСлова, ПробелДоЧисла, ПробелПослеЧисла);
	КонецЕсли;
	Если ЗначениеЗаполнено(Паттерн5) Тогда 
		ДобавитьСтроку(Таблица, Токен, Паттерн5, ПробелДоСлова, ПробелПослеСлова, ПробелДоЧисла, ПробелПослеЧисла);
	КонецЕсли;
	Если ЗначениеЗаполнено(Паттерн6) Тогда 
		ДобавитьСтроку(Таблица, Токен, Паттерн6, ПробелДоСлова, ПробелПослеСлова, ПробелДоЧисла, ПробелПослеЧисла);
	КонецЕсли;
	
КонецПроцедуры

Процедура ДобавитьСтроку(Таблица, Токен, Паттерн, ПробелДоСлова, ПробелПослеСлова, ПробелДоЧисла, ПробелПослеЧисла)
	
	СтрокаТаблицы = Новый Структура;
	СтрокаТаблицы.Вставить("Токен", Токен);
	СтрокаТаблицы.Вставить("Паттерн", Паттерн);
	СтрокаТаблицы.Вставить("ПробелДоСлова", ПробелДоСлова);
	СтрокаТаблицы.Вставить("ПробелПослеСлова", ПробелПослеСлова);
	СтрокаТаблицы.Вставить("ПробелДоЧисла", ПробелДоЧисла);
	СтрокаТаблицы.Вставить("ПробелПослеЧисла", ПробелПослеЧисла);
	
	Таблица.Добавить(СтрокаТаблицы);
	
КонецПроцедуры

Процедура ОбратнаяСортировкаШеллаПоДлинеСлов(Таблица)
	
	Позиция = Цел(Таблица.Количество() / 2);
	
	Пока Позиция > 0 Цикл
		
		Индекс = Позиция;
		Пока Индекс < Таблица.Количество() Цикл
			
			Жиндекс = Индекс - Позиция;
			Пока Жиндекс >= 0 И КомпораторПоДлинеСлов(Таблица[Жиндекс], Таблица[Жиндекс + Позиция]) Цикл
				
				Врем = Таблица[Жиндекс];
				Таблица[Жиндекс] = Таблица[Жиндекс + Позиция];
				Таблица[Жиндекс + Позиция] = Врем;
				
				Жиндекс = Жиндекс - Позиция;
			КонецЦикла;
			
			Индекс = Индекс + 1;
		КонецЦикла;
		
		Позиция = Цел(Позиция / 2);
	КонецЦикла;
	
КонецПроцедуры

Функция КомпораторПоДлинеСлов(Слово1, Слово2)
	
	Возврат СтрДлина(Слово1.Паттерн) < СтрДлина(Слово2.Паттерн);
	
КонецФункции

#КонецОбласти