#Если НЕ ВебКлиент И Не МобильныйКлиент Тогда

#Область ПрограммныйИнтерфейс

		
//Выполняет вставку изображения штрихкода в файл MSWord или OOWriter вместо тэга
//Параметры:
//			Объект - СправочникССылка.ДокументыПредприятия - ссылка на объект, для которого осуществляется вставка
//			ПечатиОрганизации - Соответствие - ключ Тег (Строка), Значение - массив дв данных картинок
//			ДвоичныеДанныеФайла - ДвоичныеДанные - двоичные данные файла, в котором осуществляется поиск тэга и вставка штрихкода
//			Расширение - Строка - расширение файла
//			УникальныйИдентификатор - УникальныйИдентификатор - формы
//			
Процедура ВставитьПечатиОрганизацииВместоТэга(
	Знач Объект, 
	Знач ПечатиОрганизации, 
	Знач ДвоичныеДанныеФайла, 
	Знач Расширение,
	Знач УникальныйИдентификатор) Экспорт
	
	МассивТегов = Новый Массив;
	Для Каждого КлючИЗначение Из ПечатиОрганизации Цикл
		МассивТегов.Добавить(КлючИЗначение.Ключ);
	КонецЦикла;	 
	
    НайденТэгПечати = ВизуализацияЭПКлиентСервер.НайтиТэгДляВставкиКартинки(
    	ДвоичныеДанныеФайла, Расширение, МассивТегов); 
	Если Не НайденТэгПечати Тогда
		Возврат;
	КонецЕсли;	
	
	Если Расширение = "odt" Тогда
		
		ДвоичныеДанныеЗаполненногоФайла = ВставкаКартинкиОрганизацииOpenOfficeСервер.ВставитьПечатиОрганизацииВФайлOdt(
			МассивТегов, ПечатиОрганизации, ДвоичныеДанныеФайла, Расширение);
		
	ИначеЕсли Расширение = "docx" Тогда
		
		ДвоичныеДанныеЗаполненногоФайла = ВставкаКартинкиОрганизацииСерверMSOffice.ВставитьПечатиОрганизацииВФайлDocx(
			МассивТегов, ПечатиОрганизации, ДвоичныеДанныеФайла, Расширение);	
		
	КонецЕсли;

	АвтозаполнениеШаблоновФайловВызовСервера.ОбновитьВерсиюИзДвоичныхДанных(
		ДвоичныеДанныеЗаполненногоФайла, Объект, "Вставка печати организации", УникальныйИдентификатор);
	
КонецПроцедуры

// Вернет имя тега для всех печатей
// 
// Возвращаемое значение:
// 	Строка - имя тега
Функция ТегЛоготипОрганизации() Экспорт
	Возврат "ЛоготипОрганизации";	
КонецФункции

#КонецОбласти

#КонецЕсли
