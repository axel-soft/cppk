#Область ПрограммныйИнтерфейс

// Возвращает символы -разделители
Функция СимволыРазделители() Экспорт
	
	СимволыРазделители = " .,;:?!-+*/\%=<>[](){}""'|~@#$^&_«»–…№—";
	СимволыРазделители = СимволыРазделители + Символ(9) + Символ(10) + Символ(13) + Символ(160) 
	 + Символ(32);
	Возврат СимволыРазделители;
	
КонецФункции	

// Функция возвращает массив символов, которые используются в качестве разделителей слов адреса.
Функция РазделителиСловПочтовогоАдреса() Экспорт
	
	РазделителиСлов = Новый Массив;
	СимволыРазделители = СимволыРазделители();
	
	Для пер = 1 По СтрДлина(СимволыРазделители) Цикл
		СимволТек = Сред(СимволыРазделители, пер, 1);
		РазделителиСлов.Добавить(СимволТек);	
	КонецЦикла;	
	
	Возврат РазделителиСлов;
	
КонецФункции

// Функция разбивает переданную строку на отдельные слова
Функция СтрокуПочтовогоАдресаВСлова(Знач СтрокаАдреса,РазделителиСлов = Неопределено) Экспорт 
	
	Если ТипЗнч(РазделителиСлов) <> Тип("Массив") Тогда
		РазделителиСлов = РазделителиСловПочтовогоАдреса();
	КонецЕсли;
	
	СтрокаАдреса = СтрЗаменить(СтрокаАдреса, "ё", "е");
	СтрокаАдреса = СтрЗаменить(СтрокаАдреса, "Ё", "Е");
	
	СловаАдреса = Новый Массив;
	
	ДлинаСтр = СтрДлина(СтрокаАдреса);
	НачалоСлова = 0;
	ДлинаСлова = 0;
	Для Счетчик = 1 По ДлинаСтр Цикл
		
		ТекущийСимвол = Сред(СтрокаАдреса,Счетчик,1);
		
		Если РазделителиСлов.Найти(ТекущийСимвол) <> Неопределено Тогда
			
			Если НачалоСлова > 0 и ДлинаСлова > 0 Тогда
				
				Слово = Сред(СтрокаАдреса,НачалоСлова,ДлинаСлова);
				СловаАдреса.Добавить(Слово);
				
			КонецЕсли;
			
			ДлинаСлова = 0;
			НачалоСлова = 0;
			
		Иначе
			
			Если НачалоСлова = 0 Тогда
				НачалоСлова = Счетчик;
			КонецЕсли;
			
			ДлинаСлова = ДлинаСлова + 1;
			
		КонецЕсли;
		
	КонецЦикла;
	
	Если НачалоСлова > 0 и ДлинаСлова > 0 Тогда
		
		Слово = Сред(СтрокаАдреса,НачалоСлова,Счетчик-1);
		СловаАдреса.Добавить(Слово);
		
	КонецЕсли;
	
	Возврат СловаАдреса;
	
КонецФункции

Функция КодировкаЧтенияЗаписиHtml() Экспорт
	
	Возврат "UTF-8";
	
КонецФункции	

Функция ЕстьСсылкиНаКартинки(ТекстПисьма) Экспорт 
	
	ТекстПисьмаДляПравки = ТекстПисьма;
	
	НачальнаяПозиция = 1;
	
	// найдем позицию body
	ТекстПисьмаДляПравкиНРег = НРег(ТекстПисьмаДляПравки);
	ПозицияНачалаBody = СтрНайти(ТекстПисьмаДляПравкиНРег, "<body");
	Если ПозицияНачалаBody <> 0 Тогда
		НачальнаяПозиция = ПозицияНачалаBody;
	КонецЕсли;	
	
	Если ПозицияНачалаBody <> 0 Тогда
		НачальнаяПозиция = ПозицияНачалаBody;
	КонецЕсли;	
	
	СтрокаПоиска1 = "<img";
	СтрокаПоиска2 = "<v:imagedata";
	
	Позиция_1 = СтрНайти(ТекстПисьмаДляПравкиНРег, СтрокаПоиска1,,НачальнаяПозиция);
	Если Позиция_1 <> 0 Тогда
		Возврат Истина;
	КонецЕсли;
	
	Позиция_2= СтрНайти(ТекстПисьмаДляПравкиНРег, СтрокаПоиска2,,НачальнаяПозиция);
	Если Позиция_2<> 0 Тогда
		Возврат Истина;
	КонецЕсли;
	
	Возврат Ложь;
	
КонецФункции

#КонецОбласти