
#Область СлужебныйПрограммныйИнтерфейс

#Область ВыполнениеЗаданийНаКлиенте

// Обработает одно задание на клиенте и запишет результат
// 
// Параметры:
// 	ОписаниеЗадания - Структура
// 	 *Задание
// 	 *Тип
// 	 *Задание
// 	 *ПредметЗадания
//  ЗаданиеЗавершено - Булево	 
// 	
Процедура ОбработатьОдноЗадание(ОписаниеЗадания, ЗаданиеЗавершено) Экспорт
	
	РеквизитыЗадания = Новый Структура("Ссылка, Тип, ПредметЗадания, Родитель",
		ОписаниеЗадания.Задание, ОписаниеЗадания.Тип, ОписаниеЗадания.ПредметЗадания, ОписаниеЗадания.Родитель);
	АктуальностьЗадания = ОбработкаОчередиЗаданийВызовСервера.АктуальностьЗадания(РеквизитыЗадания);
	
	Если Не АктуальностьЗадания.Актуально Тогда
		
		РезультатВыполнения = Новый Структура("ЗаданиеЗавершено, ЗаписьЛога",
			Истина,
			СтрШаблон(НСтр("ru = 'Задание завершено. %1'"), АктуальностьЗадания.Пояснение));
		
	ИначеЕсли ОписаниеЗадания.Тип = ПредопределенноеЗначение("Перечисление.ТипыЗаданий.СоздатьHtmlПриНачалеСогласования") Тогда
		
		РезультатВыполнения 
			= ОбработкаОчередиЗаданийКлиент.ОбработатьСоздатьHtmlПриНачалеСогласования(
				ОписаниеЗадания);
		
	ИначеЕсли ОписаниеЗадания.Тип = ПредопределенноеЗначение("Перечисление.ТипыЗаданий.ОбновитьHtmlПередОзнакомлением") Тогда
		
		РезультатВыполнения 
			= ОбработкаОчередиЗаданийКлиент.ОбработатьОбновитьHtmlПередОзнакомлением(
				ОписаниеЗадания);

	ИначеЕсли ОписаниеЗадания.Тип = ПредопределенноеЗначение("Перечисление.ТипыЗаданий.ЗавершениеОзнакомленияСогласования") Тогда
		
		РезультатВыполнения 
			= ОбработкаОчередиЗаданийКлиент.ОбработатьЗавершениеОзнакомленияСогласования(
				ОписаниеЗадания);
				
	ИначеЕсли ОписаниеЗадания.Тип = ПредопределенноеЗначение("Перечисление.ТипыЗаданий.СформироватьДанныеДляПредпросмотраФайла") Тогда
		
		РезультатВыполнения 
			= ОбработкаОчередиЗаданийКлиент.СформироватьДанныеДляПредпросмотраФайла(
				ОписаниеЗадания);
				
	КонецЕсли;
	
	ЗаданиеЗавершено = РезультатВыполнения.ЗаданиеЗавершено;
	
	ДиспетчерОбработкиОчередиЗаданийВызовСервера.ОтработатьРезультатВыполнения(
		ОписаниеЗадания.Задание, РезультатВыполнения, ОписаниеЗадания.УникальныйИдентификатор);
	
КонецПроцедуры

#КонецОбласти

#КонецОбласти
