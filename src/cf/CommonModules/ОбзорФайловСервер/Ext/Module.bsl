#Область ПрограммныйИнтерфейс

// Создает кнопки программно, для предпросмотра
// 
// Параметры:
//  Форма  - ФормаКлиентскогоПриложения                                  
//  ИмяРодителяКоманды - Строка
//  КомпактныйРежим - Булево
Процедура СоздатьКнопкиПорционногоПредпросмотра(Форма, ИмяРодителяКоманды, КомпактныйРежим = Ложь) Экспорт
	
	МаксКнопок = 9;
	Если КомпактныйРежим Тогда
		МаксКнопок = 5;
	КонецЕсли;	
	
	Для НомерКнопки = 1 По МаксКнопок Цикл
		ИмяКомандыФормы = "Страница" + Строка(НомерКнопки);
		Заголовок = Строка(НомерКнопки);
		СоздатьОднуКнопкуПорционногоПредпросмотра(Форма, ИмяРодителяКоманды, ИмяКомандыФормы, Заголовок);
	КонецЦикла;
	
КонецПроцедуры	

// Максимальное число страниц предпросмотра
// 
// Возвращаемое значение:
//  Число - если 0  - то ПредпросмотрПолностью
Функция МаксимальноеЧислоСтраницДляПредпросмотра() Экспорт
	
	УстановитьПривилегированныйРежим(Истина);
	
	МаксимальноеЧислоСтраницДляПредпросмотра = Константы.МаксимальноеЧислоСтраницДляПредпросмотра.Получить();
	 
	Возврат МаксимальноеЧислоСтраницДляПредпросмотра; 
	 
КонецФункции	 

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

Процедура СоздатьОднуКнопкуПорционногоПредпросмотра(Форма, ИмяРодителяКоманды, ИмяКомандыФормы, Заголовок)
	
	СозданнаяКоманда = РаботаСФормами.ДобавитьКоманду(
		Форма,
		ИмяКомандыФормы,
		Заголовок,
		" "); // подсказка
		
	СозданнаяКоманда.Действие = ИмяКомандыФормы;
		
	ИмяЭлемента = ИмяКомандыФормы;	
	ЭлементРодительКоманды = Форма.Элементы.Найти(ИмяРодителяКоманды);
	
	ВставитьПеред = Форма.Элементы.Вперед;
	СозданнаяКнопка = РаботаСФормами.ДобавитьКнопку(Форма, ИмяЭлемента, ЭлементРодительКоманды, 
		ИмяКомандыФормы, ВставитьПеред);   
		
	СозданнаяКнопка.ОтображениеФигуры = ОтображениеФигурыКнопки.Авто;
	СозданнаяКнопка.Заголовок = Заголовок;	
	
КонецПроцедуры	

#КонецОбласти