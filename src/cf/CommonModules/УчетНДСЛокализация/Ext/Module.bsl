
#Область СлужебныйПрограммныйИнтерфейс

// см. Справочники.СтавкиНДС.СоздатьЭлементыПервоначальногоЗаполнения
Процедура ЗаполнитьСправочникСтавкиНДС() Экспорт
	
	// Локализация
	НачатьТранзакцию();
	Попытка
		
		#Область СтавкаНДС20
		СтавкаНДС20 = УчетНДС.СтавкаНДСИзЧисла(20);
		Если СтавкаНДС20.Пустая() Тогда
			СтавкаНДС20 = Справочники.СтавкиНДС.СоздатьЭлемент();
			СсылкаСтавкаНДС20 = Справочники.СтавкиНДС.ПолучитьСсылку(Новый УникальныйИдентификатор(
				"1c993a48-b14b-11ef-9f32-50ebf63e555a"));
			СтавкаНДС20.УстановитьСсылкуНового(СсылкаСтавкаНДС20);
		Иначе
			СтавкаНДС20 = СтавкаНДС20.ПолучитьОбъект();
		КонецЕсли;
		СтавкаНДС20.Наименование = "20%";
		СтавкаНДС20.Ставка = 20;
		СтавкаНДС20.НачалоПериода = Дата(2019, 01, 01);
		СтавкаНДС20.Страна = Справочники.СтраныМира.Россия;
		ОбновлениеИнформационнойБазыХолдинг.ЗаписатьДанные(СтавкаНДС20);
		#КонецОбласти
		
		#Область СтавкаНДС18
		СтавкаНДС18 = УчетНДС.СтавкаНДСИзЧисла(18);
		Если СтавкаНДС18.Пустая() Тогда
			СтавкаНДС18 = Справочники.СтавкиНДС.СоздатьЭлемент();
			СсылкаСтавкаНДС18 = Справочники.СтавкиНДС.ПолучитьСсылку(Новый УникальныйИдентификатор(
				"c15445ef-b14d-11ef-9f32-50ebf63e555a"));
			СтавкаНДС18.УстановитьСсылкуНового(СсылкаСтавкаНДС18);
		Иначе
			СтавкаНДС18 = СтавкаНДС18.ПолучитьОбъект();
		КонецЕсли;
		СтавкаНДС18.Наименование = "18%";
		СтавкаНДС18.Ставка = 18;
		СтавкаНДС18.НачалоПериода = Дата(2004, 01, 01);
		СтавкаНДС18.КонецПериода = Дата(2018, 12, 31);
		СтавкаНДС18.Страна = Справочники.СтраныМира.Россия;
		ОбновлениеИнформационнойБазыХолдинг.ЗаписатьДанные(СтавкаНДС18);
		#КонецОбласти
		
		#Область СтавкаНДС10
		СтавкаНДС10 = УчетНДС.СтавкаНДСИзЧисла(10);
		Если СтавкаНДС10.Пустая() Тогда
			СтавкаНДС10 = Справочники.СтавкиНДС.СоздатьЭлемент();
			СсылкаСтавкаНДС10 = Справочники.СтавкиНДС.ПолучитьСсылку(Новый УникальныйИдентификатор(
				"c79e4f2c-b14d-11ef-9f32-50ebf63e555a"));
			СтавкаНДС10.УстановитьСсылкуНового(СсылкаСтавкаНДС10);
		Иначе
			СтавкаНДС10 = СтавкаНДС10.ПолучитьОбъект();
		КонецЕсли;
		СтавкаНДС10.Наименование = "10%";
		СтавкаНДС10.Ставка = 10;
		СтавкаНДС10.Страна = Справочники.СтраныМира.Россия;
		ОбновлениеИнформационнойБазыХолдинг.ЗаписатьДанные(СтавкаНДС10);
		#КонецОбласти
		
		#Область СтавкаНДС7
		СтавкаНДС7 = УчетНДС.СтавкаНДСИзЧисла(7);
		Если СтавкаНДС7.Пустая() Тогда
			СтавкаНДС7 = Справочники.СтавкиНДС.СоздатьЭлемент();
			СсылкаСтавкаНДС7 = Справочники.СтавкиНДС.ПолучитьСсылку(Новый УникальныйИдентификатор(
				"1337ba39-b14e-11ef-9f32-50ebf63e555a"));
			СтавкаНДС7.УстановитьСсылкуНового(СсылкаСтавкаНДС7);
		Иначе
			СтавкаНДС7 = СтавкаНДС7.ПолучитьОбъект();
		КонецЕсли;
		СтавкаНДС7.Наименование = "7%";
		СтавкаНДС7.Ставка = 7;
		СтавкаНДС7.НачалоПериода = Дата(2025, 01, 01);
		СтавкаНДС7.Страна = Справочники.СтраныМира.Россия;
		ОбновлениеИнформационнойБазыХолдинг.ЗаписатьДанные(СтавкаНДС7);
		#КонецОбласти
		
		#Область СтавкаНДС5
		СтавкаНДС5 = УчетНДС.СтавкаНДСИзЧисла(5);
		Если СтавкаНДС5.Пустая() Тогда
			СтавкаНДС5 = Справочники.СтавкиНДС.СоздатьЭлемент();
			СсылкаСтавкаНДС5 = Справочники.СтавкиНДС.ПолучитьСсылку(Новый УникальныйИдентификатор(
				"374d35be-b14e-11ef-9f32-50ebf63e555a"));
			СтавкаНДС5.УстановитьСсылкуНового(СсылкаСтавкаНДС5);
		Иначе
			СтавкаНДС5 = СтавкаНДС5.ПолучитьОбъект();
		КонецЕсли;
		СтавкаНДС5.Наименование = "5%";
		СтавкаНДС5.Ставка = 5;
		СтавкаНДС5.НачалоПериода = Дата(2025, 01, 01);
		СтавкаНДС5.Страна = Справочники.СтраныМира.Россия;
		ОбновлениеИнформационнойБазыХолдинг.ЗаписатьДанные(СтавкаНДС5);
		#КонецОбласти
		
		ЗафиксироватьТранзакцию();
		
	Исключение
		
		ОтменитьТранзакцию();
		ТекстОшибки = ОбработкаОшибок.ПодробноеПредставлениеОшибки(ИнформацияОбОшибке());
		ВызватьИсключение ТекстОшибки;
		
	КонецПопытки;
	// КонецЛокализация
	
КонецПроцедуры

// В функции указывается соответствие строковых представлений ставок НДС (используемые в БЭД)
// с прикладными значениями этих ставок.
//
// Параметры:
//  СоответствиеСтавокНДС - Соответствие из КлючИЗначение - заполняемое соответствие ставок НДС.
//
// Возвращаемое значение:
//  Соответствие из КлючИЗначение - заполненное соответствие ставок НДС.
//
Функция СоответствиеСтавокНДССтроковымЗначениям(СоответствиеСтавокНДС = Неопределено) Экспорт
	
	Соответствие = ?(СоответствиеСтавокНДС = Неопределено, Новый Соответствие, СоответствиеСтавокНДС);
	
	// Локализация
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	СтавкиНДС.Ставка КАК Ставка,
		|	СтавкиНДС.Ссылка КАК Ссылка
		|ИЗ
		|	Справочник.СтавкиНДС КАК СтавкиНДС
		|ГДЕ
		|	СтавкиНДС.Ставка <> 0
		|	И СтавкиНДС.РасчетнаяСтавка = ЛОЖЬ
		|	И (СтавкиНДС.Страна = ЗНАЧЕНИЕ(Справочник.СтраныМира.Россия)
		|		ИЛИ СтавкиНДС.Страна = ЗНАЧЕНИЕ(Справочник.СтраныМира.ПустаяСсылка))";
	
	РезультатЗапроса = Запрос.Выполнить();
	
	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
	
	Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
		
		КлючСоответствия = Строка(ВыборкаДетальныеЗаписи.Ставка);
		Соответствие.Вставить(КлючСоответствия , ВыборкаДетальныеЗаписи.Ссылка);
		
		КлючСоответствия = КлючСоответствия + "/" + Строка(ВыборкаДетальныеЗаписи.Ставка + 100);
		Соответствие.Вставить(КлючСоответствия , ВыборкаДетальныеЗаписи.Ссылка);
		
	КонецЦикла;
	
	Соответствие.Вставить("0%", Справочники.СтавкиНДС.НДС0);
	Соответствие.Вставить("без НДС", Справочники.СтавкиНДС.БезНДС);
	// КонецЛокализация
	
	Возврат Соответствие;
	
КонецФункции

#КонецОбласти
