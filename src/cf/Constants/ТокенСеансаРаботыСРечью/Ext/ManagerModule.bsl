///////////////////////////////////////////////////////////////////////////////////////////////////////
// Copyright (c) 2022, ООО 1С-Софт
// Все права защищены. Эта программа и сопроводительные материалы предоставляются 
// в соответствии с условиями лицензии Attribution 4.0 International (CC BY 4.0)
// Текст лицензии доступен по ссылке:
// https://creativecommons.org/licenses/by/4.0/legalcode
///////////////////////////////////////////////////////////////////////////////////////////////////////

#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ОбработчикиСобытий

Процедура ОбработкаПолученияФормы(ВидФормы, Параметры, ВыбраннаяФорма, ДополнительнаяИнформация, СтандартнаяОбработка)
	
	СтандартнаяОбработка = Ложь;
	ВыбраннаяФорма = Метаданные.Обработки.ПанельАдминистрированияРаботыСРечью.Формы.НастройкаРаботыСРечью;
	
КонецПроцедуры

#КонецОбласти

#Область ПрограммныйИнтерфейс

Процедура ЗаписатьТокенПоПараметрамВнешнегоПодключенияСеанса() Экспорт
	
	УстановитьПривилегированныйРежим(Истина);
	ТекущиеПараметры = РаботаСРечьюБМОСервер.ПолучитьПараметрыВнешнегоПодключенияСеанса();
	Если ТекущиеПараметры = Неопределено Тогда
		Возврат;
	КонецЕсли;
	Установить(ТекущиеПараметры.Токен);
	
КонецПроцедуры

Процедура УстановитьСохраненныйТокенВПараметрыВнешнегоПодключенияСеанса() Экспорт
	
	УстановитьПривилегированныйРежим(Истина);
	ТекущиеПараметры = РаботаСРечьюБМОСервер.ПолучитьПараметрыВнешнегоПодключенияСеанса();
	Если ТекущиеПараметры = Неопределено Тогда
		ТекущиеПараметры = РаботаСРечьюБМОСервер.НовыйПараметрыВнешнегоПодключенияРаботыСРечью("");
	КонецЕсли;
	ТекущиеПараметры.Токен = Получить();
	РаботаСРечьюБМОСервер.УстановитьПараметрыВнешнегоПодключенияСеанса(ТекущиеПараметры);
	
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

#КонецОбласти

#КонецЕсли