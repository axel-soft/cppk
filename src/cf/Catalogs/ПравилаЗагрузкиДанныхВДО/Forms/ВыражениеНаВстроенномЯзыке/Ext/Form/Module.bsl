#Область ОбработчикиСобытийФормы

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	Параметры.Свойство("ИнтегрированнаяСистема", ИнтегрированнаяСистема);
	Параметры.Свойство("ПредставлениеИС", ПредставлениеИС);
	Параметры.Свойство("ИмяМакета", ИмяМакета);
	
	Если ЗначениеЗаполнено(ИнтегрированнаяСистема) Тогда
		Если ЗначениеЗаполнено(ПредставлениеИС) Тогда
			Элементы.МестоВыполненияВыражения.СписокВыбора.Очистить();
			Элементы.МестоВыполненияВыражения.СписокВыбора.Добавить(
				Перечисления.МестаВыполненияВыраженийНаВстроенномЯзыке.НаСторонеДО,
				НСтр("ru = 'На стороне 1С:Документооборот'"));
			Элементы.МестоВыполненияВыражения.СписокВыбора.Добавить(
				Перечисления.МестаВыполненияВыраженийНаВстроенномЯзыке.НаСторонеИС,
				СтрШаблон(НСтр("ru = 'На стороне %1'"), ПредставлениеИС));
		КонецЕсли;
	Иначе
		Элементы.МестоВыполненияВыражения.Видимость = Ложь;
	КонецЕсли;
	
	Параметры.Свойство("ПолноеИмяОбъектаДО", ПолноеИмяОбъектаДО);
	Параметры.Свойство("ПолноеИмяОбъектаИС", ПолноеИмяОбъектаИС);
	Параметры.Свойство("ВидДокумента", ВидДокумента);
	Параметры.Свойство("ИмяРеквизитаОбъектаДО", ИмяРеквизитаОбъектаДО);
	Параметры.Свойство("ЭтоТаблица", ЭтоТаблица);
	Параметры.Свойство("Таблица", Таблица);
	Параметры.Свойство("ВычисляемоеВыражение", ВычисляемоеВыражение);
	Параметры.Свойство("МестоВыполненияВыражения", МестоВыполненияВыражения);
	Параметры.Свойство("ДоступнаТекущаяСтрока", ДоступнаТекущаяСтрока);
	
	Если Не ЗначениеЗаполнено(МестоВыполненияВыражения) Тогда
		МестоВыполненияВыражения = Перечисления.МестаВыполненияВыраженийНаВстроенномЯзыке.НаСторонеДО;
	КонецЕсли;
	
	ЗаполнитьИнструкцию();
	
КонецПроцедуры

#КонецОбласти

#Область ОбработчикиСобытийЭлементовШапкиФормы

&НаКлиенте
Процедура МестоВыполненияВыраженияПриИзменении(Элемент)
	
	ЗаполнитьИнструкцию();
	
КонецПроцедуры

#КонецОбласти

#Область ОбработчикиКомандФормы

&НаКлиенте
Процедура КомандаОК(Команда)
	
	Ответ = Новый Структура;
	Ответ.Вставить("ВычисляемоеВыражение", ВычисляемоеВыражение);
	Ответ.Вставить("МестоВыполненияВыражения", МестоВыполненияВыражения);
	
	Закрыть(Ответ);
	
КонецПроцедуры

&НаКлиенте
Процедура КомандаОчистить(Команда)
	
	ОписаниеОповещения = Новый ОписаниеОповещения("КомандаОчиститьЗавершение", ЭтотОбъект);
	ТекстВопроса = НСтр("ru = 'Очистить введенное выражение?'");
	ОбщегоНазначенияДокументооборотКлиент.ПоказатьВопросДаНет(ОписаниеОповещения, ТекстВопроса);
	
КонецПроцедуры

&НаКлиенте
Процедура КомандаПроверить(Команда)
	
	ОчиститьСообщения();
	ПроверитьВыражениеНаВстроенномЯзыке(ВычисляемоеВыражение, ПолноеИмяОбъектаДО, ПолноеИмяОбъектаИС);
	
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

&НаСервереБезКонтекста
Процедура ВывестиИмяРеквизитаДО(ИнструкцияМассив, СтруктураРеквизита, ИмяРеквизита)
	
	Если ТипЗнч(СтруктураРеквизита.Тип) = Тип("СписокЗначений")
				И СтруктураРеквизита.Тип.Количество() > 0
				И Лев(СтруктураРеквизита.Тип[0], 2) = "DM" Тогда
			ИнструкцияМассив.Добавить("<td><a href=""#");
			ИнструкцияМассив.Добавить(СтруктураРеквизита.Тип[0]);
			ИнструкцияМассив.Добавить(""">");
			ИнструкцияМассив.Добавить(ИмяРеквизита);
			ИнструкцияМассив.Добавить("</a></td>");
		Иначе
			ИнструкцияМассив.Добавить("<td>");
			ИнструкцияМассив.Добавить(ИмяРеквизита);
			ИнструкцияМассив.Добавить("</td>");
		КонецЕсли;
	
КонецПроцедуры

&НаСервереБезКонтекста
Процедура ВывестиПримерВыражения(ИнструкцияМассив, ЗаголовокРаздела, ПримерВыражения)
	
	Если ИнструкцияМассив[ИнструкцияМассив.ВГраница()] <> "</details>" Тогда
		ИнструкцияМассив.Добавить("<p>");
	КонецЕсли;
	
	ИнструкцияМассив.Добавить("<details>");
	ИнструкцияМассив.Добавить("<summary><u>");
	ИнструкцияМассив.Добавить(ЗаголовокРаздела);
	ИнструкцияМассив.Добавить("</u></summary>");
	ИнструкцияМассив.Добавить("<blockquote><pre>");
	ИнструкцияМассив.Добавить(ПримерВыражения);
	ИнструкцияМассив.Добавить("</pre></blockquote>");
	ИнструкцияМассив.Добавить("</details>");
	
КонецПроцедуры

&НаСервере
Процедура ВывестиТаблицуРеквизитов(ИнструкцияМассив, СоставРеквизитов, ВыводРеквизитовОбъектаДО = Ложь)
	
	ИнструкцияМассив.Добавить("</p><table>");
	
	ИнструкцияМассив.Добавить("<tr><td>");
	ИнструкцияМассив.Добавить("<b>");
	ИнструкцияМассив.Добавить(НСтр("ru ='Имя реквизита'"));
	ИнструкцияМассив.Добавить("</b></td>");
	
	ИнструкцияМассив.Добавить("<td><b>");
	ИнструкцияМассив.Добавить(НСтр("ru ='Синоним'"));
	ИнструкцияМассив.Добавить("</b></td>");
	ИнструкцияМассив.Добавить("</tr>");
	
	ВыведенЗаголовокДопРеквизитов = Ложь;
	ИдентификаторДопРеквизита = "00000000-0000-0000-0000-000000000000";
	ИмяДопРеквизитаИС = "";
	
	Для Каждого СтруктураРеквизита Из СоставРеквизитов Цикл
		
		Если ЗначениеЗаполнено(СтруктураРеквизита.Таблица) Тогда
			Продолжить;
		КонецЕсли;
		
		Если Не ВыводРеквизитовОбъектаДО
				И СтрНайти(СтруктураРеквизита.Имя, "ДопРеквизит_") = 1
				И МестоВыполненияВыражения = Перечисления.МестаВыполненияВыраженийНаВстроенномЯзыке.НаСторонеДО Тогда
			ИмяДопРеквизитаИС = СтруктураРеквизита.Имя;
		КонецЕсли;
		
		Если СтруктураРеквизита.ЭтоДополнительныйРеквизит И Не ВыведенЗаголовокДопРеквизитов Тогда
			ИнструкцияМассив.Добавить("<tr><td>");
			ИнструкцияМассив.Добавить("<b>");
			ИнструкцияМассив.Добавить(НСтр("ru = 'Дополнительные реквизиты:'"));
			ИнструкцияМассив.Добавить("</b>");
			ИнструкцияМассив.Добавить("</tr></td>");
			ВыведенЗаголовокДопРеквизитов = Истина;
		КонецЕсли;
		
		Если СтруктураРеквизита.ЭтоТаблица Тогда
			ИнструкцияМассив.Добавить("<tr><td>");
			ИнструкцияМассив.Добавить("<b>");
			ИнструкцияМассив.Добавить(СтрШаблон(НСтр("ru = 'Табличная часть %1'"), СтруктураРеквизита.Имя));
			ИнструкцияМассив.Добавить("</b></td>");
			
			ИнструкцияМассив.Добавить("<td><b>");
			ИнструкцияМассив.Добавить(СтруктураРеквизита.Представление);
			ИнструкцияМассив.Добавить("</b></td>");
			
			ИнструкцияМассив.Добавить("</tr>");
			
			РеквизитыТаблицы = СоставРеквизитов.НайтиСтроки(Новый Структура("Таблица", СтруктураРеквизита.Имя));
			Для Каждого РеквизитТаблицы Из РеквизитыТаблицы Цикл
				ИнструкцияМассив.Добавить("<tr>");
				
				ВывестиИмяРеквизитаДО(ИнструкцияМассив, РеквизитТаблицы, РеквизитТаблицы.Имя);
				
				ИнструкцияМассив.Добавить("<td>");
				ИнструкцияМассив.Добавить(РеквизитТаблицы.Представление);
				ИнструкцияМассив.Добавить("</td>");
				
				ИнструкцияМассив.Добавить("</tr>");
			КонецЦикла;
			Продолжить;
		КонецЕсли;
		
		Если СтруктураРеквизита.ЭтоДополнительныйРеквизит Тогда
			Если ВыводРеквизитовОбъектаДО Тогда
				ИдентификаторДопРеквизита = ОбщегоНазначения.ЗначениеРеквизитаОбъекта(
					СтруктураРеквизита.ДополнительныйРеквизит,
					"ИдентификаторДляФормул");
				ИмяРеквизита = СтрШаблон("ID: ""%1""<br>ИдентификаторДляФормул: ""%2""</br>",
					СтруктураРеквизита.ДополнительныйРеквизит.УникальныйИдентификатор(),
					ИдентификаторДопРеквизита);
			Иначе
				ИдентификаторДопРеквизита = ИдентификаторДопРеквизита(СтруктураРеквизита.Имя);
				ИмяРеквизита = СтрШаблон("ID: ""%1""", ИдентификаторДопРеквизита);
			КонецЕсли;
		Иначе
			ИмяРеквизита = СтруктураРеквизита.Имя;
		КонецЕсли;
		
		ИнструкцияМассив.Добавить("<tr>");
		
		ВывестиИмяРеквизитаДО(ИнструкцияМассив, СтруктураРеквизита, ИмяРеквизита);
		
		ИнструкцияМассив.Добавить("<td>");
		ИнструкцияМассив.Добавить(СтруктураРеквизита.Представление);
		ИнструкцияМассив.Добавить("</td>");
		
		ИнструкцияМассив.Добавить("</tr>");
		
	КонецЦикла;
	
	ИнструкцияМассив.Добавить("</table>");
	
	// Выведем примеры выражений.
	Если ВыведенЗаголовокДопРеквизитов Тогда
		Если ВыводРеквизитовОбъектаДО Тогда
			ЗаголовокРаздела = НСтр("ru = 'Пример обращения к дополнительным реквизитам приемника'");
			ПримерВыражения =
				"ЗначениеДопРеквизита = Неопределено;
				|Для Каждого Строка Из Параметры.Приемник.ДополнительныеРеквизиты Цикл
				|	Если Строка.Свойство.ИдентификаторДляФормул = ""ИдентификаторДопРеквизита"" Тогда
				|		ЗначениеДопРеквизита = Строка.Значение;
				|	КонецЕсли;
				|КонецЦикла;";
		Иначе
			ЗаголовокРаздела = НСтр("ru = 'Пример обращения к дополнительным реквизитам источника'");
			Если ЭтоТаблица Тогда
				ПримерВыражения =
					"ЗначениеДопРеквизита = Неопределено;
					|Для Каждого Строка Из Параметры.Источник.ДополнительныеРеквизиты Цикл
					|	Если СокрЛП(Строка.Свойство.УникальныйИдентификатор()) = ""ИдентификаторДопРеквизита"" Тогда
					|		ЗначениеДопРеквизита = Строка.Значение;
					|	КонецЕсли;
					|КонецЦикла;";
			Иначе
				ПримерВыражения =
					"Для Каждого Строка Из Параметры.Источник.ДополнительныеРеквизиты Цикл
					|	Если СокрЛП(Строка.Свойство.УникальныйИдентификатор()) = ""ИдентификаторДопРеквизита"" Тогда
					|		Параметры.Результат = Строка.Значение;
					|	КонецЕсли;
					|КонецЦикла;";
			КонецЕсли;
		КонецЕсли;
		ПримерВыражения = СтрЗаменить(ПримерВыражения, "ИдентификаторДопРеквизита", ИдентификаторДопРеквизита);
		ВывестиПримерВыражения(ИнструкцияМассив, ЗаголовокРаздела, ПримерВыражения);
	КонецЕсли;
	
	Если Не ПустаяСтрока(ИмяДопРеквизитаИС) Тогда
		ЗаголовокРаздела = НСтр("ru = 'Пример обращения к дополнительным реквизитам источника'");
		Если ЭтоТаблица Тогда
			ПримерВыражения = "ЗначениеДопРеквизита = Параметры.Источник.ИмяДопРеквизитаИС;";
		Иначе
			ПримерВыражения = "Параметры.Результат = Параметры.Источник.ИмяДопРеквизитаИС;";
		КонецЕсли;
		ПримерВыражения = СтрЗаменить(ПримерВыражения, "ИмяДопРеквизитаИС", ИмяДопРеквизитаИС);
		ВывестиПримерВыражения(ИнструкцияМассив, ЗаголовокРаздела, ПримерВыражения);
	КонецЕсли;
	
	Если Не ВыводРеквизитовОбъектаДО
			И МестоВыполненияВыражения = Перечисления.МестаВыполненияВыраженийНаВстроенномЯзыке.НаСторонеДО Тогда
		Если ЭтоТаблица Тогда
			ЗаголовокРаздела = НСтр("ru = 'Пример заполнения табличной части 1С:Документооборота'");
			ПримерВыражения =
				"Параметры.Результат = Новый ТаблицаЗначений;
				|Параметры.Результат.Колонки.Добавить(""Сторона"");
				|Параметры.Результат.Колонки.Добавить(""КонтактноеЛицо"");
				|Параметры.Результат.Колонки.Добавить(""Наименование"");
				|СтрокаСтороны = Параметры.Результат.Добавить();
				|СтрокаСтороны.Сторона = Параметры.Источник.Организация;
				|СтрокаСтороны.КонтактноеЛицо = Параметры.Источник.Менеджер;
				|СтрокаСтороны.Наименование = Справочники.НаименованияСторон.НайтиПоНаименованию(""Заказчик"");
				|СтрокаСтороны = Параметры.Результат.Добавить();
				|СтрокаСтороны.Сторона = Параметры.Источник.Контрагент;
				|СтрокаСтороны.КонтактноеЛицо = Параметры.Источник.КонтактноеЛицо;
				|СтрокаСтороны.Наименование = Справочники.НаименованияСторон.НайтиПоНаименованию(""Продавец"");";
		Иначе
			ЗаголовокРаздела = НСтр("ru = 'Пример заполнения реквизита 1С:Документооборота'");
			ПримерВыражения =
				"Если Параметры.Источник.Ответственный <> Неопределено Тогда
				|	ПользовательДО = Справочники.Пользователи.НайтиПоНаименованию(Параметры.Источник.Ответственный.name);
				|КонецЕсли;
				|Параметры.Результат = Сотрудники.ОсновнойСотрудникПользователя(ПользовательДО);";
		КонецЕсли;
		ВывестиПримерВыражения(ИнструкцияМассив, ЗаголовокРаздела, ПримерВыражения);
	КонецЕсли;
	
	ИнструкцияМассив.Добавить("<p>");
	
КонецПроцедуры

&НаСервере
Процедура ЗаполнитьИнструкцию()
	
	ИнструкцияМассив = Новый Массив;
	
	ИнструкцияМассив.Добавить(
		"<html>
		|<style type=""text/css"">
		|	body {
		|		overflow:    auto;
		|		margin-top:  12px;
		|		margin-left: 20px;
		|		font-family: MS Shell Dlg, Microsoft Sans Serif, sans-serif;
		|		font-size:   8pt;}
		|	table {
		|		width:       450px;
		|		font-family: MS Shell Dlg, Microsoft Sans Serif, sans-serif;
		|		font-size:   8pt;}
		|	td {vertical-align: top;}
		|	p {
		|		margin-top: 7px;}
		|</style>
		|<body>");
	
	Заголовок = НСтр("ru = 'Выражение на встроенном языке'");
	
	ИнструкцияМассив.Добавить("<p>");
	ИнструкцияМассив.Добавить(СтрШаблон(
		НСтр("ru = 'Результат вычисления выражения на встроенном языке 1С:Предприятия
			|должен присваиваться свойству %1 переменной %2.'"),
		"<b>Результат</b>",
		"<b>Параметры</b>"));
	ИнструкцияМассив.Добавить(" ");
		
	Если ЭтоТаблица Тогда
		ИнструкцияМассив.Добавить(СтрШаблон(
			НСтр("ru = 'Для заполнения таблицы результат должен иметь тип %1 с колонками:'"),
			"<b>ТаблицаЗначений</b>"));
		ИнструкцияМассив.Добавить("</p><table>");
		
		ИнструкцияМассив.Добавить("<tr><td>");
		ИнструкцияМассив.Добавить("<b>");
		ИнструкцияМассив.Добавить(НСтр("ru ='Имя реквизита'"));
		ИнструкцияМассив.Добавить("</b></td>");
		
		ИнструкцияМассив.Добавить("<td><b>");
		ИнструкцияМассив.Добавить(НСтр("ru ='Синоним'"));
		ИнструкцияМассив.Добавить("</b></td>");
		ИнструкцияМассив.Добавить("</tr>");
		
		РеквизитыОбъектаДО = Справочники.ПравилаЗагрузкиДанныхВДО.РеквизитыОбъектаДО(ПолноеИмяОбъектаДО, ВидДокумента);
		СтрокиТаблицы = РеквизитыОбъектаДО.НайтиСтроки(Новый Структура("Таблица", ИмяРеквизитаОбъектаДО));
		Для Каждого Элемент Из СтрокиТаблицы Цикл
			ИнструкцияМассив.Добавить("<tr><td>");
			ИнструкцияМассив.Добавить(Элемент.Имя);
			ИнструкцияМассив.Добавить("</td>");
			ИнструкцияМассив.Добавить("<td>");
			ИнструкцияМассив.Добавить(Элемент.Представление);
			ИнструкцияМассив.Добавить("</td></tr>");
		КонецЦикла;
		
		ИнструкцияМассив.Добавить("</table>");
	КонецЕсли;
	
	Если ДоступнаТекущаяСтрока Тогда
		ИнструкцияМассив.Добавить("<p>");
		ИнструкцияМассив.Добавить(СтрШаблон(
			НСтр("ru ='К данным текущей строки табличной части источника ""%1"", из которой выполняется
			|заполнение табличной части приемника, можно обращаться через свойство %2 переменной %3.'"),
				Таблица,
				"<b>ТекущаяСтрока</b>",
				"<b>Параметры</b>"));
	КонецЕсли;
	
	ИнструкцияМассив.Добавить("<p>");
	ИнструкцияМассив.Добавить(СтрШаблон(
		НСтр("ru = 'К объекту %1 можно обращаться через свойство %2 переменной %3. Реквизиты источника:'"),
		?(ЗначениеЗаполнено(ПредставлениеИС), ПредставлениеИС, НСтр("ru = 'интегрированной системы'")),
		"<b>Источник</b>",
		"<b>Параметры</b>"));
	
	РеквизитыОбъектаИС = РаботаСИнтегрированнымиСистемами.СписокРеквизитовОбъектаИнтегрированнойСистемы(
		?(ЗначениеЗаполнено(ИнтегрированнаяСистема), ИнтегрированнаяСистема, ИмяМакета),
		ПолноеИмяОбъектаИС);
	
	СоставРеквизитов = Справочники.ПравилаЗагрузкиДанныхВДО.КоллекцияРеквизитовОбъектаДО();
	
	// Реквизиты.
	Для Каждого МетаданныеРеквизит Из РеквизитыОбъектаИС[0].Строки Цикл
		НоваяСтрока = СоставРеквизитов.Добавить();
		НоваяСтрока.Имя = МетаданныеРеквизит.Имя;
		НоваяСтрока.Представление = МетаданныеРеквизит.Синоним;
		Если МестоВыполненияВыражения = Перечисления.МестаВыполненияВыраженийНаВстроенномЯзыке.НаСторонеИС Тогда
			НоваяСтрока.ЭтоДополнительныйРеквизит = (СтрНайти(МетаданныеРеквизит.Имя, "ДопРеквизит_") = 1);
		КонецЕсли;
	КонецЦикла;
	
	// Табличные части.
	Если РеквизитыОбъектаИС.Количество() = 2 Тогда
		Для Каждого МетаданныеТаблица Из РеквизитыОбъектаИС[1].Строки Цикл
			НоваяСтрока = СоставРеквизитов.Добавить();
			НоваяСтрока.Имя = МетаданныеТаблица.Имя;
			НоваяСтрока.ТаблицаДляСортировки = МетаданныеТаблица.Имя;
			НоваяСтрока.Представление = МетаданныеТаблица.Синоним;
			НоваяСтрока.ЭтоТаблица = Истина;
			
			Для Каждого МетаданныеРеквизит Из МетаданныеТаблица.Строки Цикл
				НоваяСтрока = СоставРеквизитов.Добавить();
				НоваяСтрока.Имя = МетаданныеРеквизит.Имя;
				НоваяСтрока.Представление = МетаданныеРеквизит.Синоним;
				НоваяСтрока.Таблица = МетаданныеТаблица.Имя;
				НоваяСтрока.ТаблицаДляСортировки = МетаданныеТаблица.Имя;
			КонецЦикла;
		КонецЦикла;
	КонецЕсли;
	
	СоставРеквизитов.Сортировать("ЭтоДополнительныйРеквизит, ТаблицаДляСортировки, ЭтоТаблица УБЫВ, Имя");
	
	ВывестиТаблицуРеквизитов(ИнструкцияМассив, СоставРеквизитов);
	
	Если МестоВыполненияВыражения = Перечисления.МестаВыполненияВыраженийНаВстроенномЯзыке.НаСторонеДО Тогда
		ИнструкцияМассив.Добавить("<p>");
		ИнструкцияМассив.Добавить(СтрШаблон(
			НСтр("ru = 'К объекту 1С:Документооборота можно обращаться через свойство %1 переменной %2. Реквизиты приемника:'"),
			"<b>Приемник</b>",
			"<b>Параметры</b>"));
		
		РеквизитыОбъектаДО = Справочники.ПравилаЗагрузкиДанныхВДО.РеквизитыОбъектаДО(ПолноеИмяОбъектаДО,, Истина);
		
		РеквизитыОбъектаДО.Сортировать("ЭтоДополнительныйРеквизит, ЭтоТаблица, Имя");
		
		ВывестиТаблицуРеквизитов(ИнструкцияМассив, РеквизитыОбъектаДО, Истина);
	КонецЕсли;
	
	ИнструкцияМассив.Добавить("</body></html>");
	
	Инструкция = СтрСоединить(ИнструкцияМассив);
	
КонецПроцедуры

&НаСервереБезКонтекста
Функция ИдентификаторДопРеквизита(ИмяДопРеквизита)
	
	ИдентификаторДопРеквизита = СтрЗаменить(ИмяДопРеквизита, "ДопРеквизит_", "");
	ИдентификаторДопРеквизита = СтрШаблон("%1-%2-%3-%4-%5",
		Лев(ИдентификаторДопРеквизита, 8),
		Сред(ИдентификаторДопРеквизита, 9, 4),
		Сред(ИдентификаторДопРеквизита, 13, 4),
		Сред(ИдентификаторДопРеквизита, 17, 4),
		Сред(ИдентификаторДопРеквизита, 21, 12));
	
	Возврат ИдентификаторДопРеквизита;
	
КонецФункции

&НаКлиенте
Процедура КомандаОчиститьЗавершение(Результат, Параметры) Экспорт
	
	Если Результат = КодВозвратаДиалога.Да Тогда
		Ответ = Новый Структура;
		Ответ.Вставить("ВычисляемоеВыражение", "");
		Ответ.Вставить("МестоВыполненияВыражения", МестоВыполненияВыражения);
		
		Закрыть(Ответ);
	КонецЕсли;
	
КонецПроцедуры

&НаСервере
Процедура ПроверитьВыражениеНаВстроенномЯзыке(ВычисляемоеВыражение, ПолноеИмяОбъектаДО, ПолноеИмяОбъектаИС)
	
	Справочники.ПравилаЗагрузкиДанныхВДО.ПроверитьВыражениеПравилаЗагрузки(
		ВычисляемоеВыражение,
		МестоВыполненияВыражения,
		?(ЗначениеЗаполнено(ИнтегрированнаяСистема), ИнтегрированнаяСистема, ИмяМакета),
		ПолноеИмяОбъектаДО,
		ПолноеИмяОбъектаИС,
		Таблица);
	
	ОбщегоНазначения.СообщитьПользователю(НСтр("ru = 'Ошибок не обнаружено'"));
	
КонецПроцедуры

#КонецОбласти