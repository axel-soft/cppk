
#Область ОбработчикиКомандФормы

&НаКлиенте
Процедура Подробнее(Команда, ПараметрыВыбора = Неопределено) Экспорт
	
	Если Команда = Команды.Подробно Тогда
		Если ТипЗнч(Параметры.Правило) = Тип("СправочникСсылка.ПравилаКоммуникаций") Тогда
			
			ПоказатьВводСтроки(Новый ОписаниеОповещения("Подробнее", ЭтотОбъект),
				СтрШаблон("%1: %2 [%3]
					|
					|%4: %5 [%6]",
					НСтр("ru = 'Правило'"),
					Параметры.Правило,
					ПолучитьНавигационнуюСсылку(Параметры.Правило),
					НСтр("ru = 'Значение'"),
					Параметры.Значение,
					ПолучитьНавигационнуюСсылку(Параметры.Значение)),
				НСтр("ru = 'Подробно'"),,
				Истина);
			
		Иначе
			
			ПоказатьВводСтроки(Новый ОписаниеОповещения("Подробнее", ЭтотОбъект),
				СтрШаблон("%1:
					|%2
					|
					|%3: %4 [%5]",
					НСтр("ru = 'Правила'"),
					ОписаниеМножестваПравил(Параметры.Правило),
					НСтр("ru = 'Значение'"),
					Параметры.Значение,
					ПолучитьНавигационнуюСсылку(Параметры.Значение)),
				НСтр("ru = 'Подробно'"),,
				Истина);
			
		КонецЕсли;
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

&НаСервереБезКонтекста
Функция ОписаниеМножестваПравил(Правила)
	
	Представления = Новый Массив;
	Если ТипЗнч(Правила) = Тип("Строка") Тогда
		
		Для Каждого Подстрока Из СтрРазделить(Правила, ";") Цикл
			
			Попытка
				Ссылка = XMLЗначение(Тип("СправочникСсылка.ПравилаКоммуникаций"), Подстрока);
			Исключение
				Продолжить;
			КонецПопытки;
			
			Представления.Добавить(СтрШаблон("%1 [%2]", Ссылка, ПолучитьНавигационнуюСсылку(Ссылка))); 
			
		КонецЦикла;
		
	Иначе
		
		Для Каждого Элемент Из Правила Цикл
			
			Представления.Добавить(СтрШаблон("%1 [%2]", Элемент.Ключ, ПолучитьНавигационнуюСсылку(Элемент.Ключ))); 
			
		КонецЦикла;
		
	КонецЕсли;
	
	Возврат СтрСоединить(Представления, ";
		|");
	
КонецФункции

#КонецОбласти
