
#Область ОбработчикиСобытийФормы

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	Документ = Параметры.Документ;
	Подписант = Параметры.Подписант;
	
	Элементы.Документ.Видимость = НЕ Параметры.ОднаЗадача;
	Элементы.Подписант.Видимость = НЕ Параметры.ОднаЗадача;
	
	Если ЗначениеЗаполнено(Параметры.Организации) Тогда
		Организации.ЗагрузитьЗначения(Параметры.Организации);
	Иначе
		Организации.ЗагрузитьЗначения(Делопроизводство.ОрганизацииВСторонахДокумента(Документ));
	КонецЕсли;
	
	Организации.СортироватьПоПредставлению();
	
	// Выделим организацию, руководителем которой является подписант, жирным шрифтом
	Руководители = Справочники.Организации.ОтветственныеСотрудникиПоОрганизациям(
		Перечисления.ОтветственныеЛицаОрганизаций.РуководительОрганизации, Организации);
	
	ОтмеченыВсе = Истина;
	Для Каждого Организация Из Организации Цикл
		СтрокаРуководителя = Руководители.Найти(Подписант);
		Если СтрокаРуководителя <> Неопределено И СтрокаРуководителя.Сотрудник = Подписант Тогда
			// Текущий подписант является руководителем этой организации
			Организация.Пометка = Истина;
		КонецЕсли;
		ОтмеченыВсе = ОтмеченыВсе И Организация.Пометка;
	КонецЦикла;
	
	// Если подписант является руководителем всех имеющихся организаций - нет смысла выделять их жирным
	Если ОтмеченыВсе Тогда
		УсловноеОформление.Элементы[0].Использование = Ложь;
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти

#Область ОбработчикиСобытийЭлементовТаблицыФормыОрганизации

&НаКлиенте
Процедура ОрганизацииВыборЗначения(Элемент, Значение, СтандартнаяОбработка)
	Закрыть(Организации[Значение].Значение);
КонецПроцедуры 

#КонецОбласти
