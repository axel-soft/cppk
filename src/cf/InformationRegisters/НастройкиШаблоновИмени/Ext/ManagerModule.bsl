#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ПрограммныйИнтерфейс

// Очистить все записи по шаблону.
// 
// Параметры:
//  ШаблонИмени  - СправочникССылка.ШаблоныИменФайлов
Процедура ОчиститьЗаписиПоШаблону(ШаблонИмени) Экспорт
	
	УстановитьПривилегированныйРежим(Истина);
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	НастройкиШаблоновИмени.ТипОбъекта КАК ТипОбъекта,
		|	НастройкиШаблоновИмени.Вид,
		|	НастройкиШаблоновИмени.РольФайла
		|ИЗ
		|	РегистрСведений.НастройкиШаблоновИмени КАК НастройкиШаблоновИмени
		|ГДЕ
		|	НастройкиШаблоновИмени.ШаблонИмени = &ШаблонИмени";
	
	Запрос.УстановитьПараметр("ШаблонИмени", ШаблонИмени );
	Результат = Запрос.Выполнить();
	
	// сперва все сотрем
	Выборка = Результат.Выбрать();
	Пока Выборка.Следующий() Цикл
		
		НаборЗаписей = РегистрыСведений.НастройкиШаблоновИмени.СоздатьНаборЗаписей();
		НаборЗаписей.Отбор.ТипОбъекта.Установить(Выборка.ТипОбъекта);
		НаборЗаписей.Отбор.Вид.Установить(Выборка.Вид);
		НаборЗаписей.Отбор.РольФайла.Установить(Выборка.РольФайла);
		НаборЗаписей.Записать();
		
	КонецЦикла;	
	
КонецПроцедуры	

#КонецОбласти

#КонецЕсли
