
&НаСервере
Процедура ЦППК_ЦППК_ОбработатьВыделенныеПослеНаСервере()
	
	Для Каждого Строка Из Элементы.Список.ВыделенныеСтроки Цикл 
		
		ОбъектМетаданных = ОбщегоНазначения.ОбъектМетаданныхПоИдентификатору(Строка.ЗависимыйОбъектМетаданных);
		КлючеваяОперация = СтрШаблон(НСтр("ru = 'Обновление кэширующих данных.%1'"), ОбъектМетаданных.ПолноеИмя());
		ОтметкаВремени = ОценкаПроизводительности.НачатьЗамерВремени();
		Менеджер = ОбщегоНазначения.МенеджерОбъектаПоПолномуИмени(ОбъектМетаданных.ПолноеИмя());
		
		ИдентификаторыЗависимыхОбъектов = Новый Массив;
		ИдентификаторыЗависимыхОбъектов.Добавить(Строка.ЗависимыйОбъектМетаданных);
		
		// Менеджеры кэширующих данных должны самостоятельно обрабатывать исключения. Код, обрабатывающий исключения
		// здесь, служит исключительно для подстраховки: обновление кэширующих данных не должно входить в бесконечный цикл.
		Попытка
			
			Менеджер.ОбработатьОчередьОбновленияКэширующихДанных(ИдентификаторыЗависимыхОбъектов);
			ОценкаПроизводительности.ЗакончитьЗамерВремени(КлючеваяОперация, ОтметкаВремени);
			
		Исключение
			
			ИнформацияОбОшибке = ПодробноеПредставлениеОшибки(ИнформацияОбОшибке());
			ЗаписьЖурналаРегистрации(ОбновлениеКэширующихДанных.СобытиеЖурналаРегистрации(ОбъектМетаданных.ПолноеИмя()),
				УровеньЖурналаРегистрации.Ошибка,
				ОбъектМетаданных,,
				ИнформацияОбОшибке);
			НаборЗаписей = РегистрыСведений.ОчередьОбновленияКэширующихДанных.СоздатьНаборЗаписей();
			НаборЗаписей.Отбор.ЗависимыйОбъектМетаданных.Установить(Строка.ЗависимыйОбъектМетаданных);
			НаборЗаписей.Прочитать();
			Для Каждого Запись Из НаборЗаписей Цикл
				Запись.Попыток = Запись.Попыток + 1;
				Запись.ИнформацияОбОшибке = ИнформацияОбОшибке;
			КонецЦикла;
			НаборЗаписей.Записать();
			
		КонецПопытки;
		
	КонецЦикла;
	
КонецПроцедуры

&НаКлиенте
Процедура ЦППК_ЦППК_ОбработатьВыделенныеПосле(Команда)
	
	ЦППК_ЦППК_ОбработатьВыделенныеПослеНаСервере();
	
	Элементы.Список.Обновить();
	
КонецПроцедуры
        